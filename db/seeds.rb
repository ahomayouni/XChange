toronto_addresses =
["1442 Lawrence Ave W Toronto ON",
"100 Lotherton Ptway Toronto ON",
"2925 Dufferin St Toronto ON",
"2350 Bridletowne Cir Toronto ON",
"110 Canongate Trail Toronto ON",
"4750 Jane St Toronto ON",
"615 Sentinel Rd Toronto ON",
"33 Eastmount Ave Toronto ON",
"1710 Bayview Ave Toronto ON",
"703 Soudan Ave Toronto ON",
"373 Strathmore Blvd Toronto ON",
"52 Milverton Blvd Toronto ON",
"280 Donlands Ave Toronto ON",
"56 Woodycrest Ave Toronto ON",
"31 Fielding Ave Toronto ON",
"34 Butternut St Toronto ON",
"36 Thorncliffe Ave Toronto ON",
"148 Barrington Ave Toronto ON",
"235 Glebemount Ave Toronto ON",
"9 Haldon Ave Toronto ON",
"841 Millwood Rd Toronto ON",
"35 Brian Peck Cres Toronto ON",
"183 Coleman Ave Toronto ON",
"92 Glebeholme Blvd Toronto ON",
"52 Newmarket Ave Toronto ON",
"88 Torrens Ave Toronto ON",
"37 Taylor Dr Toronto ON",
"432 Sutherland Dr Toronto ON",
"989 Logan Ave Toronto ON",
"51 Donlands Ave Toronto ON",
"145 Strathmore Blvd Toronto ON",
"21 Burkebrook Pl Toronto ON",
"56 Thorncliffe Park Dr Toronto ON",
"194 Queensdale Ave Toronto ON",
"88 Coleman Ave Toronto ON",
"75 Eastdale Ave Toronto ON",
"510 Dawes Rd Toronto ON",
"921 Millwood Rd Toronto ON",
"12 Bater Ave Toronto ON",
"51 Wolverleigh Blvd Toronto ON",
"894 Broadview Ave Toronto ON",
"153 Donlea Dr Toronto ON",
"1 Glenwood Terr Toronto ON",
"7 Park Vista Toronto ON",
"767 Sammon Ave Toronto ON",
"390 Dawes Rd Toronto ON",
"102 Goodwood Park Crt Toronto ON",
"243 Cosburn Ave Toronto ON",
"162 Barker Ave Toronto ON",
"69 Mallory Cres Toronto ON",
"91 Fulton Ave Toronto ON",
"22 Chester Hill Rd Toronto ON",
"53 Thorncliffe Park Dr Toronto ON",
"49 Thorncliffe Park Dr Toronto ON",
"4 Grandstand Pl Toronto ON",
"551 The West Mall Toronto ON",
"205 Sherway Gardens Rd Toronto ON",
"6 Eva Rd Toronto ON",
"11 Bournemouth Rd Toronto ON",
"820 Burnhamthorpe Rd Toronto ON",
"36 Bemersyde Dr Toronto ON",
"30 Silverthorne Bush Dr Toronto ON",
"286 Lanor Ave Toronto ON",
"2369 Lake Shore Blvd W Toronto ON",
"117 Burlingame Rd Toronto ON",
"21 Ashmore Ave Toronto ON",
"101 Subway Cres Toronto ON",
"15 Viking Lane Toronto ON",
"28 Farningham Cres Toronto ON",
"75 Burlington St Toronto ON",
"5 Capri Rd Toronto ON",
"2200 Lake Shore Blvd W Toronto ON",
"2220 Lake Shore Blvd W Toronto ON",
"300 Antibes Dr Toronto ON",
"256 John Garland Blvd Toronto ON",
"28 Orpington Cres Toronto ON",
"2801 Jane St 111 Toronto ON",
"1025 Scarlett Rd Toronto ON",
"190 Exbury Rd Toronto ON",
"99 Hullrick Dr Toronto ON",
"2999 Jane St Toronto ON",
"60 Callowhill Dr Toronto ON",
"55 Habitant Dr Toronto ON",
"4500 Jane St Toronto ON",
"11 Moline Dr Toronto ON",
"6 Ladywood Dr Toronto ON",
"3455 Weston Rd Toronto ON",
"3400 Weston Rd Toronto ON",
"2328 Islington Ave Toronto ON",
"17 Seguin Crt Toronto ON",
"30 Humberline Dr Toronto ON",
"83 Meadow Oak Pl Toronto ON",
"200 Cabernet Cir Toronto ON",
"11 Bergamot Ave Toronto ON",
"2004 Sheppard Ave W Toronto ON",
"68 Bergamot Ave Toronto ON",
"17 Tinton Cres Toronto ON",
"63 Primula Cres Toronto ON",
"700 Humberwood Blvd Toronto ON",
"117 Upper Humber Dr Toronto ON",
"3330 Weston Rd Toronto ON",
"94 Odoardo Di Santo Cir Toronto ON",
"50 Panorama Crt Toronto ON",
"425 Clendenan Ave Toronto ON",
"39 Heintzman St Toronto ON",
"528 Old Weston Rd Toronto ON",
"72 Deforest Rd Toronto ON",
"82 Uxbridge Ave Toronto ON",
"83 Hounslow Heath Rd Toronto ON",
"1696 St Clair Ave W Toronto ON",
"1884 Davenport Rd Toronto ON",
"2984 Dundas St W Toronto ON",
"417 Annette St Toronto ON",
"3 Grenadier Hts Toronto ON",
"305 Quebec Ave Toronto ON",
"106 Evelyn Cres Toronto ON",
"87 Woodside Ave Toronto ON",
"68 Medland Cres Toronto ON",
"65 Windermere Ave Toronto ON",
"1638 Bloor St W Toronto ON",
"34 Glenwood Ave Toronto ON",
"33 Pelham Park Gdns Toronto ON",
"22 Durie St Toronto ON",
"96 Hook Ave Toronto ON",
"80 Fairview Ave Toronto ON",
"66 Pacific Ave Toronto ON",
"2188 Bloor St W Toronto ON",
"103 The Queensway Toronto ON",
"720 Trethewey Dr Toronto ON",
"3 Michael Power Pl Toronto ON",
"328 Symington Ave Toronto ON",
"106 Pacific Ave Toronto ON",
"284 Indian Rd Toronto ON",
"37 Mayfield Ave Toronto ON",
"390 Annette St Toronto ON",
"3052 Dundas St W Toronto ON",
"25 Oakview Ave Toronto ON",
"20 Gothic Ave Toronto ON",
"45 Oakmount Rd Toronto ON",
"38 Connolly St Toronto ON",
"2 Annette St Toronto ON",
"91 Runnymede Rd Toronto ON",
"111 Keele St Toronto ON",
"2521 Dundas St W Toronto ON",
"75 Laws St Toronto ON",
"330 Symington Ave Toronto ON",
"92 Van Dusen Blvd Toronto ON",
"50 Cordova Ave Toronto ON",
"315 Kennedy Ave Toronto ON",
"29 Webb Ave Toronto ON",
"734 Indian Rd Toronto ON",
"3 Glenlake Ave Toronto ON",
"2 Aberfoyle Cres Toronto ON",
"37 Vernon St Toronto ON",
"218 Howard Park Ave Toronto ON",
"25 Mabelle Ave Toronto ON",
"48 Nottingham Dr Toronto ON",
"7 Gardenvale Rd Toronto ON",
"462 Glenlake Ave Toronto ON",
"156 Colbeck St Toronto ON",
"60 Southport St Toronto ON",
"81 Lemonwood Dr Toronto ON",
"1830 Bloor St W Toronto ON",
"41 Mabelle Ave Toronto ON",
"82 Woodside Ave Toronto ON",
"228 Wiltshire Ave Toronto ON",
"17 Michael Power Pl Toronto ON",
"15 Michael Power Pl Toronto ON",
"65 High Park Ave Toronto ON",
"85 Coe Hill Dr Toronto ON",
"1823 Davenport Rd Toronto ON",
"53 Kenneth Ave Toronto ON",
"111 Pacific Ave Toronto ON",
"710 Trethewey Dr Toronto ON",
"416 Symington Ave Toronto ON",
"10 Riverwood Pky Toronto ON",
"105 The Queensway Toronto ON",
"66 Waterton Rd Toronto ON",
"68 Waterton Rd Toronto ON",
"27 Austin Ave Toronto ON",
"70 Coady Ave Toronto ON",
"143 Leslie St Toronto ON",
"118 Hiltz Ave Toronto ON",
"258 Hiawatha Rd Toronto ON",
"207 Jones Ave Toronto ON",
"14 Larchmount Ave Toronto ON",
"262 Rhodes Ave Toronto ON",
"15 Pape Ave Toronto ON",
"1105 Dundas St E Toronto ON",
"67 Curzon St Toronto ON",
"81 Redwood Ave Toronto ON",
"233 Carlaw Ave Toronto ON",
"260 Carlaw Ave Toronto ON",
"62 Hiltz Ave Toronto ON",
"323 Highfield Rd Toronto ON",
"57 Rhodes Ave Toronto ON",
"48 Caroline Ave Toronto ON"];

listing_categories = ["Film & Photography","Audio Visual Equipment","Projectors & Screens","Drones",
  "DJ Equipment","Transport","Storage","Electronics","Party & Events","Sports","Musical Instruments",
  "Home / Office / Garden","Kids & Baby","Holiday & Travel","Clothing"]

def geo_code(address) 
  results = Geocoder.search(address)
  lat = nil
  lon = nil
  if results.first
    lat = "#{results.first.coordinates[0]}"
    lon = "#{results.first.coordinates[1]}"
  end
  return [lat,lon]
end

def seed_listing(title, description, category, userid, image_name, image_type, address)
  listing = Listing.new
  listing.title = title
  listing.description = description
  listing.category = category
  listing.start_lending = Faker::Date.forward(1)
  listing.end_lending = Faker::Date.forward(365)
  listing.user_id = userid
  listing.images.attach(
      io: File.open(File.join(Rails.root, ("/app/assets/images/"+image_name))),
      filename: image_name,
      content_type: image_type,
  )
  listing.address = address
  lat_long = geo_code(listing.address)
  listing.latitude = lat_long[0]
  listing.longitude = lat_long[1]
  if listing.save
    puts "Successfully created Listing id: #{listing.id} with user_id: #{listing.user_id}"
  else
    listing.errors.full_messages.each do |message|
    puts message
    end
  end
end

def seed_user (name, email, pw, addr, desc, image_name, image_type)
  @temp_user = User.new(name:  name,
             email: email,
             password:              pw,
             password_confirmation: pw,
             admin: false,
             activated: true,
             activated_at: Time.zone.now,
             person: Person.create(
             address: addr,
             phone_number: Faker::PhoneNumber.cell_phone,
             description: desc
             ))
  @temp_user.person.image.attach(
      io: File.open(File.join(Rails.root, ("/app/assets/images/"+image_name))),
      filename: image_name,
      content_type: image_type,
  )
  @temp_user.save
end

def seed_user_production (name, email, pw, addr, desc)
  @temp_user = User.new(name:  name,
             email: email,
             password:              pw,
             password_confirmation: pw,
             admin: false,
             activated: true,
             activated_at: Time.zone.now,
             person: Person.create(
             address: addr,
             phone_number: Faker::PhoneNumber.cell_phone,
             description: desc
             ))
  @temp_user.save
end

# Create 100 Fake users. Also Template in how we can prepopulate the database.
@admin_user = User.new(name:  "admin",
             email: "admin@admin.com",
             password:              "admin",
             password_confirmation: "admin",
             admin: true,
             activated: true,
             activated_at: Time.zone.now,
             person: Person.create(
              address: toronto_addresses[0],
              phone_number: '6471678732',
              description: 'I am a bot created by the master Peter Tanugraha'
             ))
@admin_user.save
Notification.create(recipient: @admin_user,actor: @admin_user,action:"created_new_account",notifiable:@admin_user)

9.times do |n|
  name  = Faker::FunnyName.name
  email = "example-#{n+1}@beepbeep.org"
  password = "worstpassword"
  @current_user = User.new(name:  name,
               email: email,
               password:              password,
               password_confirmation: password,
               activated: true,
               activated_at: Time.zone.now,
               person: Person.create(
                address: toronto_addresses[n+1],
                phone_number: '6471678732',
                description: 'I am a bot created by the master Peter Tanugraha'
               ))
  @current_user.save
  Notification.create(recipient: @current_user,actor: @current_user,action:"created_new_account",notifiable:@current_user)

end

if Rails.env == "production"
  seed_user_production("Arash", "arash@gmail.com", "12345", "262 Rhodes Ave Toronto", 'Developer at XChange')
  seed_user_production("Peter", "peter@gmail.com", "12345", "15 Pape Ave Toronto", 'Developer at XChange')
  seed_user_production("Maru", "maru@gmail.com", "12345", "1830 Bloor St W Toronto", 'Developer at XChange')
  seed_user_production("Adi", "adi@gmail.com", "12345", "260 Carlaw Ave Toronto", 'Developer at XChange')
  seed_user_production("Arnav", "arnav@gmail.com", "12345", "62 Hiltz Ave Toronto", 'Developer at XChange')
  seed_user_production("KC", "KC@gmail.com", "12345", "67 Curzon St Toronto", 'Developer at XChange')
else
  seed_user("Arash", "arash@gmail.com", "12345", "262 Rhodes Ave Toronto", 'Developer at XChange',"arash.jpg", 'image/jpeg')
  seed_user("Peter", "peter@gmail.com", "12345", "15 Pape Ave Toronto", 'Developer at XChange','peter.jpeg', 'image/jpeg')
  seed_user("Maru", "maru@gmail.com", "12345", "1830 Bloor St W Toronto", 'Developer at XChange','maru.jpg', 'image/jpeg')
  seed_user("Adi", "adi@gmail.com", "12345", "260 Carlaw Ave Toronto", 'Developer at XChange','adi.jpeg', 'image/jpeg')
  seed_user("Arnav", "arnav@gmail.com", "12345", "62 Hiltz Ave Toronto", 'Developer at XChange','arnav.jpg', 'image/jpeg')
  seed_user("KC", "KC@gmail.com", "12345", "67 Curzon St Toronto", 'Developer at XChange', 'KC.jpg', 'image/jpeg')
  seed_user("Donald Trump", "trump@gmail.com", "12345", "156 Colbeck St Toronto", 'President of the United States', 'trump.jpg', 'image/jpeg')
  seed_user("Donald Trump", "trump@gmail.com", "12345", "156 Colbeck St Toronto", 'President of the United States', 'trump.jpg', 'image/jpeg')
  seed_user("Neil deGrasse Tyson", "neil@gmail.com", "12345", "65 High Park Ave Toronto", 'The Space Guy', 'neil.jpg', 'image/jpeg')
  seed_user("Chandler Bing", "chandler@gmail.com", "12345", "2 Aberfoyle Cres Toronto", "I'm not great at advice. Can I interest you in a sarcastic comment?", 'chandler.jpg', 'image/jpeg')
  seed_user("Donald Knuth", "donald@gmail.com", "12345", "52 Milverton Blvd Toronto", "An algorithm must be seen to be believed.", 'donald.jpg', 'image/jpeg')
  # Seeding istings
  seed_listing("Canon FX Camera", "35 mm SLR Camera", "Film & Photography", User.find_by(name:"Arash").id, 'camera-seed.jpeg', 'image/jpeg', "710 Trethewey Dr Toronto")
  seed_listing("Saw for carpenting", "Traditional style saw", "Home / Office / Garden", User.find_by(name:"Peter").id, 'saw.jpg', 'image/jpeg', "2925 Dufferin St Toronto")
  seed_listing("HP Office Printer", "Not used. Message for details", "Home / Office / Garden", User.find_by(name:"Adi").id, 'printer.jpg', 'image/jpeg', "36 Thorncliffe Ave Toronto")
  seed_listing("Drone with Camera", "Comes with a 4K Camera", "Drones", User.find_by(name:"Arnav").id, 'drone.jpg', 'image/jpeg', "1830 Bloor St W Toronto")
  seed_listing("DJ studio", "Available for daily rentals", "DJ Equipment", User.find_by(name:"Maru").id, 'dj.jpg', 'image/jpeg', "82 Woodside Ave Toronto")
  seed_listing("Bicycle", "Sport. Never used.", "Sports", User.find_by(name:"KC").id, 'bike.jpeg', 'image/jpeg', "111 Pacific Ave Toronto")
  seed_listing("Trump's Tower", "My humble tower.", "Holiday & Travel", User.find_by(name:"Donald Trump").id, 'tower.jpg', 'image/jpeg', "325 Bay St, Toronto")
  seed_listing("Cosmos DVD set", "My very own TV show", "Film & Photography", User.find_by(name:"Neil deGrasse Tyson").id, 'cosmos.jpg', 'image/jpeg', "81 Lemonwood Dr Toronto")
  seed_listing("OLD Home Phone", "Old collectible", "Home / Office / Garden", User.find_by(name:"Chandler Bing").id, 'phone.png', 'image/png', "103 The Queensway Toronto")
  seed_listing("The Art of Computer Programming", "Collection by Donald Knuth", "Home / Office / Garden", User.find_by(name:"Donald Knuth").id, 'dbook.jpg', 'image/jpg', "989 Logan Ave Toronto")
end 

# Get corresponding longitude and latitude from user.peron.address and fill the location model
User.all.each_with_index do |u,index|
  results = Geocoder.search(toronto_addresses[index])
  if results.first
    lat = "#{results.first.coordinates[0]}"
    long = "#{results.first.coordinates[1]}"
  else
    lat = "-1" 
    long = "-1"
  end
  
  u.location = Location.create(
  address:toronto_addresses[index],
  latitude:lat,
  longitude:long)

  if u.save
    puts "Updated location info for user with id: #{u.id}"
  else
     "Could not update location info of user_id: #{u.id}"
  end

#  5.times do |i|
#
#    listing = Listing.new
#    listing.title = "#{u.name}'s listing"
#    listing.description = Faker::Friends.quote
#    listing.category = listing_categories.sample
#    listing.start_lending = Faker::Date.forward(1)
#    listing.end_lending = Faker::Date.forward(365)
#    listing.price_per_day = 2
#    listing.user_id = u.id

    # 1 Image for all users for now
#    listing.images.attach(
#    io: File.open(File.join(Rails.root, "/app/assets/images/books.jpg")),
#    filename: 'books.jpg',
#    content_type: 'image/jpeg',
#    )

#    if listing.save
#      puts "Successfully created Listing id: #{listing.id} with user_id: #{listing.user_id}"
#    else
#      listing.errors.full_messages.each do |message|
#        puts message
#      end
#    end

 # end
  
end

# seeds to add commetns to all people; This also changes the ratings of the respective epople
# Person.all do |p|
#   p.comments.create( body: "hello", rating: 5, listing_id: nil, reply_id: 1, reply_type: "Listing", created_at: "2018-11-13 00:15:33", updated_at: "2018-11-13 00:15:33", commenter_id: 1, subject_id: p.id)
#   p.comments.create( body: "hello", rating: 8, listing_id: nil, reply_id: 1, reply_type: "Listing", created_at: "2018-11-13 00:15:33", updated_at: "2018-11-13 00:15:33", commenter_id: 1, subject_id: p.id)
# end

# Listing.create( title: "Test", description: "great", category: "Film & Photography", price_per_day: 10, start_lending: "2018-11-11 00:00:00", end_lending: "2018-11-11 00:00:00", user_id: 1, rating: 3)

# 10.times do |i|
#   Listing.first.comments.create(body: "How this user is great", rating: 6)
# end
