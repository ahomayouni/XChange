<div class="container-fluid">
  <div class="container">
    <div class="row">
      <div class="col-lg-3 mt-3">
         <h1><%= @listing.title %></h1>
         <span class="badge badge-pill mb-2"><%= @listing.category %> </span> <br />
            <% if is_listing_owner %>
               <%= link_to "Edit", edit_listing_path(@listing), class: 'btn btn-outline-info'%>
            <% end %>
            <%if not_listing_owner%>
               <%= link_to "Request Item", borrow_requests_path(@listing), class: 'btn btn-outline-info mt-2'%>
            <%end%>
            <h5 class="mt-3"> Owner: </h5>
            <%= image_tag("empty-user-icon.png", :class => "user-icon rounded") %>
            <h5 class="mt-3"> <%= @listing.user.name %> </h5>
				    <%= button_to "View Profile", user_path(@listing.user), class:"btn btn-primary", :method => :get %>
            <%= button_to "Send Message", user_path(@listing.user), class:"btn btn-primary", :method => :get %>
      </div>
      <div class="col-lg-9 mb-5">
        <div class="card mt-4">
            <% (0...@listing.images.count).each do |image| %>
              <%= image_tag(@listing.thumbnail(image), :class => "card-img-top")%>
            <% end %>
            <div class="card-body pb-3">
              <h3 class="card-title"><%= @listing.title %></h3>
              <p class="card-text"><%= @listing.description %></p>
              <p class="card-text"> Average Rating:</p>
              <p class="card-text">
                <!-- I know this isn't the cleanest looking erb code.. but it works -->
                <% if get_rounded_rating == 0 %>
                    <p class="card-text"> No ratings yet </p>
                <% else %>
                  <% for i in 1..get_rounded_rating do %>
                    <i class="material-icons">
                    grade
                    </i>
                  <%end%>
                <% end %>
              </p>
            </div>
        </div>
        <!--  For adding a review -->
        <div class="card mt-2">
          <div class="card-header">Review this Item:</div>
          <div class="card text p-3">
           <%= form_for [@listing, Comment.new], class:"form-control" do |f| %>
                <%= f.text_area :body, placeholder: "Add a comment", class:'form-group' %><br/>
                <%= f.number_field :rating, placeholder: "Add rating" %><br/>
                <%= f.submit "Add Comment", class:'btn btn-outline-info mt-2' %>
              <% end %>
          </div>
        </div>
        <!-- Showing existing comments on the post  -->
        <%= render(partial: 'comments/comment', collection: @listing.comments) %>
      </div>
     </div>

   </div>
</div>
